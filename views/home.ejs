<%- include('partials/header', { page: 'home', activeCategory: 'all', categories: categories }) %>

<%
// Get featured article (first one)
const featuredArticle = articles && articles.length > 0 ? articles[0] : null;
// Get remaining articles for the list
const listArticles = articles && articles.length > 1 ? articles.slice(1, 5) : [];
%>

<!-- Hero / Featured Article -->
<section class="hero container">
  <div class="hero-top">
    <% if (featuredArticle) { %>
    <div class="hero-label">
      <span class="hero-dot"></span>
      <span class="hero-category"><%= featuredArticle.category_name || 'News' %></span>
    </div>
    <% } else { %>
    <div class="hero-label">
      <span class="hero-dot"></span>
      <span class="hero-category">Latest</span>
    </div>
    <% } %>
    <form action="/search" method="GET" class="search-box">
      <input type="text" name="q" placeholder="Search articles..." data-i18n-placeholder="searchPlaceholder">
      <button type="submit" class="search-btn" aria-label="Search">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"></circle>
          <path d="M21 21l-4.35-4.35"></path>
        </svg>
      </button>
    </form>
  </div>
  <% if (featuredArticle) { %>
  <h1><a href="/article/<%= featuredArticle.id %>"><%= featuredArticle.title %></a></h1>
  <p><%= featuredArticle.summary %></p>
  <% } else { %>
  <h1>AI Credit News</h1>
  <p>AI-powered insights for credit & financial services</p>
  <% } %>
</section>

<main class="container">
  <div class="home-layout">
    <div class="main-content">
      <!-- Numbered Article List -->
      <% if (listArticles.length > 0) { %>
        <% listArticles.forEach((article, index) => { %>
          <article class="article-numbered">
            <span class="article-num"><%= String(index + 1).padStart(2, '0') %></span>
            <div>
              <div class="article-cat"><%= article.category_name || 'News' %></div>
              <h4><a href="/article/<%= article.id %>"><%= article.title %></a></h4>
              <p><%= article.summary ? article.summary.substring(0, 100) + '...' : '' %></p>
            </div>
          </article>
        <% }) %>
      <% } else if (!featuredArticle) { %>
        <div class="empty-state">
          <h3>No articles yet</h3>
          <p>Check back soon for the latest AI in credit & banking news.</p>
        </div>
      <% } %>

      <div class="view-more">
        <a href="/all" data-en="View more articles →" data-es="Ver mas articulos →">View more articles →</a>
      </div>
    </div>

    <aside class="sidebar">
      <!-- Newsletter Subscribe -->
      <div class="sidebar-subscribe">
        <h3 data-en="Newsletter" data-es="Boletin">Newsletter</h3>
        <p data-en="Weekly AI credit insights delivered to your inbox every Monday." data-es="Perspectivas semanales de IA crediticia en tu correo cada lunes.">Weekly AI credit insights delivered to your inbox every Monday.</p>
        <form action="/subscribe" method="POST">
          <input type="email" name="email" placeholder="your@email.com" data-i18n-placeholder="emailPlaceholder" required>
          <button type="submit" data-en="Subscribe" data-es="Suscribirse">Subscribe</button>
        </form>
      </div>

      <!-- Weekly Editorial -->
      <% if (editorial) { %>
      <div class="sidebar-editorial">
        <h3 data-en="Weekly Editorial" data-es="Editorial Semanal">Weekly Editorial</h3>
        <h4><%= editorial.title %></h4>
        <p><%= editorial.content ? editorial.content.substring(0, 150) + '...' : '' %></p>
        <a href="/editorial/<%= editorial.id %>" class="editorial-link" data-en="Read Editorial →" data-es="Leer Editorial →">Read Editorial →</a>
      </div>
      <% } %>
    </aside>
  </div>
</main>

<%- include('partials/footer') %>
